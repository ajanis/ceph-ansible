telegraf_plugins_extra:
  - name: nginx
    options:
      urls:
        - "https://maas.home.prettybaked.com/nginx_status"
  - name: procstat
    options:
      pattern: "nginx"
      prefix: "maas-http"
  - name: procstat
    options:
      pattern: "regiond"
      prefix: "maas-regiond"
  - name: procstat
    options:
      pattern: "rackd"
      prefix: "maas-rackd"
  - name: procstat
    options:
      pattern: "squid"
      prefix: "maas-proxy"
  - name: procstat
    options:
      pattern: "postgres"
      prefix: "maas-db"
  - name: logparser
    options:
      files:
        - "/var/log/maas/http/*.log"
      from_beginning: "false"
      grok:
        patterns:
          - '%{CLIENT:client_ip} %{NOTSPACE:ident} %{NOTSPACE:auth} \[%{HTTPDATE:ts:ts-httpd}\]"(?:%{WORD:verb:tag} %{NOTSPACE:request} \
            (?:HTTP/%{NUMBER:http_version:float})?|%{DATA})" %{NUMBER:resp_code:tag} (?:%{NUMBER:resp_bytes:int}|-)%{QS:referrer} \
            %{QS:agent}(?:%{NUMBER:request_time}|-) (?:%{NUMBER:upstream_connect_time}|-) %{NOTSPACE:x_forwarded_for}'
        measurement: nginx_access_log
  - name: x509_cert
    options:
      sources:
        - https://maas.home.prettybaked.com:443
